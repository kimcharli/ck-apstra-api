---
- name: Get Device Facts
  hosts: all
  connection: local
  # connection: juniper.device.pyez
  gather_facts: no
  collections:
    - juniper.device

  vars:
    host: ""
    user: ""
    passwd: ""
    ansible_ssh_pass: ""
    local_lo0_ip: ""
    peer_lo0_ip: ""
    local_ae0_ip: ""
    peer_ae0_ip: ""
    local_bgp_as: ""
    peer_bgp_as: ""
    out_folder: "../../temp"

  tasks:
    - debug:
        var: ansible_host
        
    # - name: Create pristine configurations
    #   ansible.builtin.template:
    #     src: "../template.pristine.conf.j2"
    #     dest: "/.pristine.conf"

    - name: Create configurations
      ansible.builtin.template:
        src: "../template.conf.j2"
        dest: "/.conf"

    - name: Load override configuration
      config:
        load: 'override'
        src: "/.conf"
        timeout: 60
      register: response

    - name: Print the response
      debug:
        var: response
